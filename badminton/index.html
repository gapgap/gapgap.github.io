<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>API Booking Scheduler</title>
  <style>
    :root { --gap: .8rem; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 1rem; margin: 0; background: #fff; color: #111; }
    .container { max-width: 980px; margin: 0 auto; padding: .5rem; }
    h1 { font-size: 1.4rem; margin: .5rem 0 1rem; }
    input, button, select { font-size: 1rem; padding: .6rem .7rem; margin: .25rem 0; width: 100%; box-sizing: border-box; }
    label { display: block; margin-top: .4rem; font-weight: 600; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: var(--gap); }
    @media (max-width: 720px) { .row { grid-template-columns: 1fr; } }
    .panel { background: #fafafa; border: 1px solid #eee; border-radius: 12px; padding: 1rem; margin-top: 1rem; }
    .muted { color: #666; font-size: .95rem; font-weight: 400; }
    .highlight { font-weight: 700; }
    .controls { margin-top: .8rem; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--gap); }
    @media (max-width: 600px) { .controls { grid-template-columns: 1fr; } }
    .log { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background: #f7f7f9; border: 1px solid #eee; padding: 1rem; margin-top: 1rem; white-space: pre-wrap; max-height: 40vh; overflow-y: auto; border-radius: 12px; }
    .inline-actions { display: flex; gap: .5rem; flex-wrap: wrap; align-items: center; }
    .inline-actions input[type="file"] { width: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>API Scheduler</h1>

    <!-- Mode + Send option -->
    <div class="row">
      <label>
        Mode (2 only)
        <select id="mode">
          <option value="manual">Manual testing</option>
          <option value="friday">Friday booking (next week)</option>
        </select>
      </label>

      <label>
        Send option
        <select id="sendOption">
          <option value="now">Send now</option>
          <option value="schedule">Schedule</option>
        </select>
      </label>

      <label id="sendAtWrap" style="display:none">
        Send at (TH)
        <input type="datetime-local" id="sendAt" />
      </label>
    </div>

    <!-- Manual config -->
    <div id="manualPanel" class="panel">
      <div class="row">
        <label>
          Date (TH)
          <input type="date" id="manualDate" />
        </label>
        <label>
          Hour (TH) [17‚Äì21]
          <select id="manualHour">
            <option value="17">17:00</option>
            <option value="18">18:00</option>
            <option value="19">19:00</option>
            <option value="20">20:00</option>
            <option value="21">21:00</option>
          </select>
        </label>
      </div>
      <p class="muted">* End time = +1 hour, both converted to epoch (UTC) in the request.</p>
    </div>

    <!-- Credential profiles -->
    <div class="panel">
      <div class="row">
        <label>
          Credential profile
          <select id="profileSelect"></select>
        </label>
        <label>
          Profile name
          <input type="text" id="profileName" placeholder="e.g. My QR iPhone" />
        </label>
      </div>
      <div class="row">
        <label>
          Token
          <input type="password" id="token" placeholder="Enter token" />
        </label>
        <label>
          Device ID
          <input type="text" id="device_id" placeholder="Enter device_id" />
        </label>
      </div>
      <div class="inline-actions">
        <button id="btnSaveProfile">üíæ Save / Update Profile</button>
        <button id="btnNewProfile">üÜï New Profile</button>
        <button id="btnDeleteProfile">üóëÔ∏è Delete Profile</button>
        <button id="btnExportProfiles">üì§ Export Profiles</button>
        <label>üì• Import Profiles
          <input type="file" id="inputImportProfiles" accept="application/json" />
        </label>
      </div>
      <p class="muted">Profiles are kept in this browser (localStorage). Use Export/Import to move between devices.</p>
    </div>

    <!-- Friday booking info -->
    <div id="friPanel" class="panel" style="display:none">
      <div><span class="highlight">Target Friday (TH):</span> <span id="friDate">-</span></div>
      <div><span class="highlight">Will book slots (TH):</span> <span id="friSlots">-</span></div>
      <div class="muted">Both requests will be sent <b>concurrently</b>.</div>
    </div>

    <!-- General params -->
    <div class="row">
      <label>
        Payment Method
        <select id="paymentMethod">
          <option value="9">QR</option>
          <option value="1">Point</option>
        </select>
      </label>

      <label>
        Amount
        <input type="number" id="amount" value="2" min="1" />
      </label>
    </div>

    <div class="row">
      <label>
        Retry attempts
        <input type="number" id="retryCount" value="5" min="0" step="1" />
      </label>
      <label>
        Retry delay (fixed)
        <input type="text" value="500 ms" disabled />
      </label>
    </div>

    <!-- Schedule preview -->
    <div id="scheduleInfo" class="panel" style="display:none">
      <div><span class="highlight">Next send at:</span> <span id="nextSend">-</span></div>
      <div class="muted">Countdown: <span id="countdown">--:--:--</span></div>
    </div>

    <!-- Actions -->
    <div class="controls">
      <button id="btnTest">üîç Test Only (show request)</button>
      <button id="btnSubmit">üöÄ Submit</button>
      <button id="btnClearLog">üßπ Clear Log</button>
    </div>

    <div class="log" id="log"></div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
